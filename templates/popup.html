<!DOCTYPE html>
<html>
<head>
    <title>Download pro</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
</head>
<body><center>
    <h1>check your video! this not your video please go back and refresh try again</h1>
    <H2>how:open video and click three dots there you can see download button</H2>
    <progress id="progressbar" value="0" max="100"></progress>
    <p id="progressmsg"></p>
    <center><button id="downloadbtn" disabled>Download</button></center>
    <br>
    <script>
        var stream = JSON.parse('{{ stream_json|safe }}');
        var progressbar = document.getElementById('progressbar');
        var progressmsg = document.getElementById('progressmsg');
        var downloadbtn = document.getElementById('downloadbtn');
        var dirs = '{{ dirs }}';

        var video = document.createElement('video');
        video.src = stream.url;
        video.controls = true;
        document.body.appendChild(video);

        video.addEventListener('canplay', function() {
            progressmsg.innerHTML = 'Video ready for download.';
            downloadbtn.disabled = false;
        });

        downloadbtn.addEventListener('click', function() {
            window.location.href = stream.url;
        });
    </script>
    </center>
</body>
</html>